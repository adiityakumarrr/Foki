<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FOKI</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
    background:linear-gradient(135deg,#e0eafc,#cfdef3);
    color:#1d1d1f;
}

/* SPLASH SCREEN */
#splash{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:linear-gradient(135deg,#667eea,#764ba2);
    color:white;
    font-size:60px;
    letter-spacing:6px;
    font-weight:700;
    z-index:1000;
    animation:fadeOut 1s ease forwards;
    animation-delay:2s;
}

@keyframes fadeOut{
    to{
        opacity:0;
        visibility:hidden;
        transform:scale(1.1);
    }
}

/* MAIN */
.container{
    height:100vh;
    padding:20px;
    box-sizing:border-box;
}

.dashboard{
    display:flex;
    height:92%;
    gap:20px;
}

.card{
    background:white;
    border-radius:22px;
    padding:30px;
    box-shadow:0 12px 30px rgba(0,0,0,0.12);
    overflow:hidden;
}

.center{ width:60%; text-align:center; }

.right{ 
    width:40%; 
    text-align:center; 
    display:flex;
    flex-direction:column;
    align-items:center;
}

.subject{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:20px;
    margin:15px 0;
    background:#f4f6fb;
    border-radius:18px;
    font-size:20px;
}

.play-btn{
    padding:8px 16px;
    border-radius:10px;
    border:none;
    background:#d1f2eb;
    font-weight:600;
    font-size:16px;
}

.play-btn.active{
    background:#ff6b81;
    color:white;
}

#totalTime{
    font-size:48px;
    margin-top:40px;
    font-weight:700;
}

.chart-container{
    width:270px;
    height:270px;
    margin-top:25px;
}

.footer{
    text-align:center;
    margin-top:10px;
    font-size:16px;
    font-weight:500;
}

input{
    padding:12px;
    margin:8px;
    border-radius:12px;
    border:1px solid #ccc;
    width:260px;
    font-size:16px;
}

button{
    padding:10px 20px;
    border-radius:12px;
    border:none;
    cursor:pointer;
    font-weight:600;
    font-size:15px;
    background:linear-gradient(135deg,#667eea,#764ba2);
    color:white;
}
</style>
</head>

<body>

<div id="splash">FOKI</div>

<div class="container">

    <div class="dashboard">

        <div class="card center">
            <h2>üìö Study Subjects</h2>
            <div id="subjects"></div>
            <input type="text" id="newSubject" placeholder="Add Subject">
            <button onclick="addSubject()">Add</button>
        </div>

        <div class="card right">
            <h2>Total Studied Today</h2>
            <div id="totalTime">00:00:00</div>

            <div class="chart-container">
                <canvas id="studyChart"></canvas>
            </div>
        </div>

    </div>

    <div class="footer">
        Made with ‚ù§Ô∏è by Aditya
    </div>

</div>

<script>

let timer=null;
let activeSubject=null;
let userData=null;
let chart=null;

/* COLOR POOL FOR UNLIMITED SUBJECTS */
const colorPool=[
"#36a2eb","#ff6384","#ffce56","#4bc0c0",
"#9966ff","#ff9f40","#2ecc71","#e74c3c",
"#9b59b6","#1abc9c","#f39c12","#34495e",
"#16a085","#d35400","#8e44ad","#27ae60"
];

setTimeout(()=>{
    document.getElementById("splash").style.display="none";
},2500);

function loadData(){
    const today=new Date().toLocaleDateString();
    const saved=localStorage.getItem("FOKI_USER");

    if(saved){
        userData=JSON.parse(saved);
        if(userData.date !== today){
            for(let s in userData.subjects){
                userData.subjects[s].total=0;
            }
            userData.date=today;
            saveData();
        }
    }else{
        userData={
            date:today,
            subjects:{
                Physics:{total:0},
                Chemistry:{total:0},
                Math:{total:0}
            }
        };
        saveData();
    }
}

function saveData(){
    localStorage.setItem("FOKI_USER",JSON.stringify(userData));
}

function renderSubjects(){
    const container=document.getElementById("subjects");
    container.innerHTML="";
    for(let sub in userData.subjects){
        let div=document.createElement("div");
        div.className="subject";
        div.innerHTML=`
            <span>${sub} - <span id="${sub}Time">${formatTime(userData.subjects[sub].total)}</span></span>
            <button class="play-btn" id="${sub}Btn" onclick="toggleTimer('${sub}')">‚ñ∂</button>
        `;
        container.appendChild(div);
    }
}

function toggleTimer(sub){
    const btn=document.getElementById(sub+"Btn");

    if(activeSubject===sub){
        clearInterval(timer);
        btn.classList.remove("active");
        btn.innerText="‚ñ∂";
        activeSubject=null;
        saveData();
        return;
    }

    if(activeSubject){
        document.getElementById(activeSubject+"Btn").classList.remove("active");
        document.getElementById(activeSubject+"Btn").innerText="‚ñ∂";
    }

    clearInterval(timer);
    activeSubject=sub;
    btn.classList.add("active");
    btn.innerText="‚è∏";

    timer=setInterval(()=>{
        userData.subjects[sub].total++;
        updateUI();
    },1000);
}

function updateUI(){
    let total=0;
    let labels=[];
    let data=[];
    let colors=[];
    let index=0;

    for(let s in userData.subjects){
        total+=userData.subjects[s].total;
        document.getElementById(s+"Time").innerText=
            formatTime(userData.subjects[s].total);

        if(userData.subjects[s].total > 0){
            labels.push(s);
            data.push(userData.subjects[s].total);
            colors.push(colorPool[index % colorPool.length]);
            index++;
        }
    }

    document.getElementById("totalTime").innerText=formatTime(total);
    updateChart(labels,data,colors);
}

function addSubject(){
    const name=document.getElementById("newSubject").value.trim();
    if(name && !userData.subjects[name]){
        userData.subjects[name]={total:0};
        saveData();
        renderSubjects();
        document.getElementById("newSubject").value="";
    }
}

function formatTime(sec){
    let h=String(Math.floor(sec/3600)).padStart(2,'0');
    let m=String(Math.floor((sec%3600)/60)).padStart(2,'0');
    let s=String(sec%60).padStart(2,'0');
    return `${h}:${m}:${s}`;
}

function initChart(){
    const ctx=document.getElementById("studyChart").getContext("2d");
    chart=new Chart(ctx,{
        type:"pie",
        data:{
            labels:["No Study Yet"],
            datasets:[{
                data:[1],
                backgroundColor:["#e0eafc"]
            }]
        },
        options:{
            responsive:true,
            maintainAspectRatio:false,
            plugins:{
                legend:{ 
                    position:"bottom",
                    labels:{
                        font:{
                            size:16   /* Bigger legend text */
                        }
                    }
                }
            }
        }
    });
}

function updateChart(labels,data,colors){
    if(data.length===0){
        chart.data.labels=["No Study Yet"];
        chart.data.datasets[0].data=[1];
        chart.data.datasets[0].backgroundColor=["#e0eafc"];
    }else{
        chart.data.labels=labels;
        chart.data.datasets[0].data=data;
        chart.data.datasets[0].backgroundColor=colors;
    }
    chart.update();
}

loadData();
renderSubjects();
initChart();
updateUI();

</script>

</body>
</html>